<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title><?= $title;?></title>

    <?= $this->load->view('inc/css')?>

</head>
<body class="page-body gray">

<div class="page-container"><!-- add class "sidebar-collapsed" to close sidebar by default, "chat-visible" to make chat appear always -->
    
    <div class="sidebar-menu">

        <div class="sidebar-menu-inner">
            <?= $this->load->view('inc/sidebar')?>
        </div>

    </div>

    <div class="main-content"> <!---START MAIN CONTENT -->


      <div class="row">
        <div class="col-md-7">
          
          <div class="panel panel-default panel-shadow">
          <div class="panel-heading">
            <div class="panel-title">
              <h2><?= $title?></h2>
            </div>
        
          </div>
          <div class="panel-body"> 
        
              <ul class="nav nav-tabs"><!-- available classes "bordered", "right-aligned" -->
                <li class="active">
                  <a href="#home" data-toggle="tab">
                    <span class="visible-xs"><i class="entypo-home"></i></span>
                    <span class="hidden-xs">Default</span>
                  </a>
                </li>
                <li>
                  <a href="#profile" data-toggle="tab">
                    <span class="visible-xs"><i class="entypo-user"></i></span>
                    <span class="hidden-xs">Scholars</span>
                  </a>
                </li>
                <li>
                  <a href="#mode" data-toggle="tab">
                    <span class="visible-xs"><i class="entypo-pencil"></i></span>
                    <span class="hidden-xs">Change Mode of Payment</span>
                  </a>
                </li>
              </ul>
              
              <div class="tab-content">
                <div class="tab-pane active" id="home">
                    <form  class="form-horizontal form-groups-bordered" id="frmSubmit" action="<?php echo base_url()?>admin/compute_assessment" method="POST">
                        <input type="hidden" name="stud_id" id="stud_id" value="<?= $detail->row('stud_id') ?>">
                        <input type="hidden" name="stud_name" value="<?=$detail->row('stud_lastname') .', '.$detail->row('stud_firstname').' '.$detail->row('stud_middlename').' '.$detail->row('stud_suffix') ?>">
                        <input type="hidden" name="stud_queue" value="<?=$detail->row('stud_queue')?>">
                        <input type="hidden" name="sy_id" value="<?= $sy?>">

                        <div class="msg"></div>
                        
                        <div class="form-group">
                          
                          
                          <div class="col-sm-5 col-md-offset-1">
                            <label class="control-label bold">Grade Level</label><br/>
                            <select class="form-control txt_lvl" name="lvl_id" > 
                              <?php  
                                $lvl_id = $detail->row('lvl_id'); 
                                foreach($level->result() as $g): ?>
                                <option value="<?=$g->lvl_id?>" <?=($lvl_id == $g->lvl_id ? 'selected="" ' : '' )?> ><?=$g->lvl_name?></option>
                              <?php endforeach; ?>
                            </select>
                          </div>

                          <div class="col-sm-5">
                            <label class="control-label bold">Section</label><br/>
                            <select class="form-control txt_sec" name="sec_id"> 
                              <?php 
                                  $sec_id = $section_assignment->row('sec_id'); 
                                    foreach ($section->result() as $r): ?>
                                      <option value="<?=$r->sec_id?>" <?=($sec_id == $r->sec_id ? 'selected="" ' : '' )?> ><?=$r->sec_name?></option>
                              <?php endforeach; 
                              ?>
                            </select>
                          </div>
                        </div>

                        
                        <div class="form-group">
                          <label class="col-sm-3 control-label bold">Type</label>
                          
                          <div class="col-sm-3">
                            <input class="icheck" type="radio" value="Old Student" name="stud_type" required="" <?=($detail->row('stud_type') == 'Old Student' ? 'checked="" ' : '') ?> >
                                <label>OLD</label>
                          </div>

                          <div class="col-sm-3">
                            <input class="icheck" type="radio" value="New Student" name="stud_type" required="" <?=($detail->row('stud_type') == 'New Student' ? 'checked="" ' : '') ?>>
                                <label>NEW</label>
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="col-sm-3 control-label bold">Mode of Payment</label>
                          
                          <div class="col-sm-6">
                            <select class="form-control" name="as_mode"> 
                                 <?php $mode = $detail->row('as_mode'); ?>
                                <option value="Cash" <?=($mode =='Cash'? 'selected="" ':'') ?> >ANNUAL (CASH)</option>
                                <option value="Semestral" <?= ($mode =='Semestral'? 'selected="" ':'') ?> >SEMESTRAL</option>
                                <option value="Quarterly" <?= ($mode =='Quarterly'? 'selected="" ':'') ?> >QUARTERLY</option>
                                <option value="Monthly" <?= ($mode =='Monthly'? 'selected="" ':'') ?> >MONTHLY</option>
                            </select>
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="col-sm-3 control-label bold">Sibling Discount</label>
                          
                          <div class="col-sm-3">
                            <input class="icheck" type="radio" value="Y" name="as_sib_discount" required="" <?=($assessment->row('as_sib_discount') == 'Y' || empty($assessment->row('as_sib_discount')) ? 'checked="" ' : '' )?>>
                                <label>YES</label>
                          </div>

                          <div class="col-sm-3">
                            <input class="icheck" type="radio" value="N" name="as_sib_discount" <?=($assessment->row('as_sib_discount') == 'N' || empty($assessment->row('as_sib_discount')) ? 'checked="" ' : '' )?> >
                                <label>NO</label>
                          </div>
                        </div>


                        <div class="form-group">
                          <label class="col-sm-3 control-label bold">Reservation</label>
                          
                          <div class="col-sm-3">
                            <div class="checkbox">
                                <label>
                                  <input type="checkbox" name="as_is_reserve" value="Y" <?=($assessment->row('as_is_reserve') == 'Y' ? 'checked="" ' : '' )?> > Reserve?
                                </label>
                              </div>
                          </div>

                           <div class="col-sm-3">
                              <?php 
                                  $name = strtoupper($detail->row('stud_lastname')) .', '.strtoupper($detail->row('stud_firstname')).'%';
                                  $cnt  = $this->module->get_query("SELECT * from reservation WHERE stud_fullname LIKE '%".$name."' ");

                                  if($cnt->num_rows() == 1 ){
                                    echo '<span class="badge badge-roundless badge-danger"><i class="fa fa-check"></i> WITH RESERVATION </span>';
                                  }
                              ?>
                           </div>
                        </div>

                        
                            <div class="row">
                              <div class="col-md-12">
                                <div class="form-group">
                                <table class="table m-0 table-condensed table-bordered">
                                  <thead>
                                    <th colspan="4">OTHERS</th>
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td>
                                        <label class="control-label bold">Books</label><br/>
                                        <input type="text" class="form-control digit" name="as_book" autofocus=""  autocomplete="off" value="<?=( empty($assessment->row('as_book')) ? '' :  $assessment->row('as_book'))?>">
                                      </td>
                                      <td>
                                        <label class="control-label bold">Notebooks/Diary</label><br/>
                                        <input type="text" class="form-control digit" name="as_notebook" autocomplete="off" value="<?=( empty($assessment->row('as_notebook')) ? '' : $assessment->row('as_notebook') )?>">
                                      </td>
                                      <td>
                                        <label class="control-label bold">School Uniforms</label><br/>
                                        <input type="text" class="form-control digit" name="as_uniform" autofocus=""  autocomplete="off" value="<?=( empty($assessment->row('as_uniform')) ? '' :  $assessment->row('as_uniform'))?>">
                                      </td>
                                      <td>
                                        <label class="control-label bold">P.E. Shoes</label><br/>
                                        <input type="text" class="form-control digit" name="as_others" autocomplete="off" value="<?=( empty($assessment->row('as_others')) ? '' : $assessment->row('as_others') )?>">
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                                </div>
                              </div>
                            </div>      
                        
                        
                        <div class="form-group">
                          <div class="col-md-3 col-md-offset-9 text-right">
                             <button class="btn btn-success btn-lg btn-block" type="submit">Compute</button>
                          </div>
                        </div>

                    </form>
                  
                </div>
                <div class="tab-pane" id="profile">

                  <form  id="frmSubmitScholar" action="<?php echo base_url()?>admin/compute_scholar" method="POST">
                  
                  <table class="table">
                    <tbody>
                        <input type="hidden" name="stud_id" id="stud_id" value="<?= $detail->row('stud_id') ?>">
                        <input type="hidden" name="stud_name" value="<?=$detail->row('stud_lastname') .', '.$detail->row('stud_firstname').' '.$detail->row('stud_middlename').' '.$detail->row('stud_suffix') ?>">
                        <input type="hidden" name="stud_queue" value="<?=$detail->row('stud_queue')?>">
                        <input type="hidden" name="sy_id" value="<?= $sy?>">
                        <input type="hidden" name="stud_type" value="Scholar">
                        <tr>
                          <td>
                            
                            <label class="control-label bold">Grade Level</label><br/>
                            <select class="form-control txt_lvl_sch" name="lvl_id" > 
                              <?php  
                                $lvl_id = $detail->row('lvl_id'); 
                                foreach($level->result() as $g): ?>
                                <option value="<?=$g->lvl_id?>" <?=($lvl_id == $g->lvl_id ? 'selected="" ' : '' )?> ><?=$g->lvl_name?></option>
                              <?php endforeach; ?>
                            </select>

                          </td>

                          <td>
                            <label class="control-label bold">Section</label><br/>
                            <select class="form-control txt_sec_sch" name="sec_id"> 
                              <?php 
                                  $sec_id = $section_assignment->row('sec_id'); 
                                    foreach ($section->result() as $r): ?>
                                      <option value="<?=$r->sec_id?>" <?=($sec_id == $r->sec_id ? 'selected="" ' : '' )?> ><?=$r->sec_name?></option>
                              <?php endforeach; 
                              ?>
                            </select>

                          </td>

                          <td>
                             <label class="control-label bold">Mode of Payment</label>
                          
                              <select class="form-control" name="as_mode"> 
                                   <?php $mode = $detail->row('as_mode'); ?>
                                  <option value="Cash" <?=($mode =='Cash'? 'selected="" ':'') ?> >ANNUAL (CASH)</option>
                                  <option value="Semestral" <?= ($mode =='Semestral'? 'selected="" ':'') ?> >SEMESTRAL</option>
                                  <option value="Quarterly" <?= ($mode =='Quarterly'? 'selected="" ':'') ?> >QUARTERLY</option>
                                  <option value="Monthly" <?= ($mode =='Monthly'? 'selected="" ':'') ?> >MONTHLY</option>
                              </select>
                          </td>
                        </tr>
                    </tbody>
                  </table>

                  <table class="table table-bordered">
                    <thead>
                      <th>DESCRIPTION</th>
                      <th>AMOUNT</th>
                    </thead>

                    <tbody>
                       <tr>
                        <td class="vmiddle bold">Percentage (%)</td>
                        <td>
                          <select class="form-control" name="as_percentage">
                            <?php $percentage = $assessment->row('as_percentage'); ?>
                            <option value="0" <?=($percentage == 0? 'selected="" ':'') ?> >0%</option>
                            <option value="25" <?=($percentage ==25? 'selected="" ':'') ?> >25%</option>
                            <option value="50" <?=($percentage ==50? 'selected="" ':'') ?> >50%</option>
                            <option value="75" <?=($percentage ==75? 'selected="" ':'') ?> >75%</option>
                            <option value="100" <?=($percentage ==100? 'selected="" ':'') ?> >100%</option>
                          </select>
                        </td>
                      </tr>

                      <tr>
                        <td class="vmiddle bold">Tuition Fee</td>
                        <td>
                          <input class="form-control digit text-right" name="as_tf" type="input" autocomplete="off" value="<?=( empty($assessment->row('as_tf')) ? '' :  $assessment->row('as_tf'))?>">
                        </td>
                      </tr>

                      <tr>
                        <td class="vmiddle bold">Miscellaneous Fee</td>
                        <td>
                          <input class="form-control digit text-right" name="fee_other_schl_fee" type="input" autocomplete="off" value="<?=( empty($assessment->row('as_other_schl_fee')) ? '' :  $assessment->row('as_other_schl_fee'))?>">
                        </td>
                      </tr>

                    </tbody>
                  </table>

                  <table class="table m-0 table-condensed table-bordered">
                    <thead>
                      <th colspan="4">OTHERS</th>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <label class="control-label bold">Books</label><br/>
                          <input type="text" class="form-control digit" name="as_book" autofocus=""  autocomplete="off" value="<?=( empty($assessment->row('as_book')) ? '' :  $assessment->row('as_book'))?>">
                        </td>
                        <td>
                          <label class="control-label bold">Notebooks/Diary</label><br/>
                          <input type="text" class="form-control digit" name="as_notebook" autocomplete="off" value="<?=( empty($assessment->row('as_notebook')) ? '' : $assessment->row('as_notebook') )?>">
                        </td>
                        <td>
                          <label class="control-label bold">School Uniforms</label><br/>
                          <input type="text" class="form-control digit" name="as_uniform" autofocus=""  autocomplete="off" value="<?=( empty($assessment->row('as_uniform')) ? '' :  $assessment->row('as_uniform'))?>">
                        </td>
                        <td>
                          <label class="control-label bold">P.E. Shoes</label><br/>
                          <input type="text" class="form-control digit" name="as_others" autocomplete="off" value="<?=( empty($assessment->row('as_others')) ? '' : $assessment->row('as_others') )?>">
                        </td>
                      </tr>
                    </tbody>
                  </table>

                  <br/>

                  <div class="form-group">
                    <div class="col-md-3 col-md-offset-9 text-right">
                       <button class="btn btn-success btn-lg btn-block" type="submit">Compute</button>
                    </div>
                  </div>

                </form>
                </div>

                 <div class="tab-pane" id="mode">
                    
                    <form  class="form-horizontal form-groups-bordered" id="frmSubmitMode" action="<?php echo base_url()?>admin/compute_mode" method="POST">
                        <div class="msg"></div>



                         <div class="row">
                           <div class="col-sm-5 col-md-offset-1">
                            <label class="control-label bold">Grade Level</label><br/>
                            <select class="form-control txt_lvl" name="lvl_id" > 
                              <?php  
                                $lvl_id = $detail->row('lvl_id'); 
                                foreach($level->result() as $g): ?>
                                <option value="<?=$g->lvl_id?>" <?=($lvl_id == $g->lvl_id ? 'selected="" ' : '' )?> ><?=$g->lvl_name?></option>
                              <?php endforeach; ?>
                            </select>

                            <input type="hidden" name="stud_id" value="<?=$this->uri->segment(3)?>">
                          </div>


                          <div class="col-sm-5">
                            <label class="control-label bold">Mode of Payment</label><br/>
                            <select class="form-control" name="as_mode"> 
                                 <?php $mode = $detail->row('as_mode'); ?>
                                <option value="Cash" <?=($mode =='Cash'? 'selected="" ':'') ?> >ANNUAL (CASH)</option>
                                <option value="Semestral" <?= ($mode =='Semestral'? 'selected="" ':'') ?> >SEMESTRAL</option>
                                <option value="Quarterly" <?= ($mode =='Quarterly'? 'selected="" ':'') ?> >QUARTERLY</option>
                                <option value="Monthly" <?= ($mode =='Monthly'? 'selected="" ':'') ?> >MONTHLY</option>
                            </select>
                          </div>
                         </div>



                          <hr/>
                          <br/>
                        <h4 class="bold">PAYMENT HISTORY</h4>
                        <table class="table table-bordered datatable">
                          <thead>
                            <th>No.</th>
                            <th>Mode</th>
                            <th>Tuition Fee</th>
                            <th>Other Fees</th>
                            <th>Total</th>
                            <th>Date</th>
                          </thead>

                          <tbody>
                            <?php 
                                $stud_id = $this->uri->segment(3);
                                $payment_history = $this->module->get_query(" SELECT * FROM payment_history WHERE stud_id = ".$stud_id." ORDER BY as_date DESC "); 
                                $cnt = 1;
                                
                                foreach($payment_history->result() as $p ):
                                
                                $disc_tf  = $p->as_disc_tf;
                                $total    = $p->as_total;

                                $others   = $total - $disc_tf;

                            ?>
                            
                              <tr>
                                <td class="text-center"><?= $cnt++ ?></td>
                                <td><?= $p->as_mode ?></td>
                                <td class="text-right "><?= number_format($p->as_disc_tf,2) ?></td>
                                <td class="text-right "><?= number_format($others,2) ?></td>
                                <td class="text-right bold"><?= number_format($p->as_total,2) ?></td>
                                <td class="text-right"><?= date('Y-m-d h:i a', strtotime($p->as_date)) ?></td>
                              </tr>

                            <?php endforeach; ?>
                          </tbody>
                        </table>
                        
                        <div class="form-group">
                          <div class="col-md-3 col-md-offset-9 text-right">
                             <button class="btn btn-success btn-lg btn-block" type="submit">Compute</button>
                          </div>
                        </div>
                    </form>
                 </div>

              </div>

          </div>
        </div>

        </div>

        <div class="col-md-5">
          <div class="panel panel-default panel-shadow">
          <div class="panel-heading" style="background-color: #373e4a; ">
            <div class="panel-title">
              <h3 class="text-white">Assessed Fees</h3>
            </div>
          </div>

          <div class="panel-body">
            
            <div class="row">
              <div class="col-md-6">
                <small>QUEUE NO.: </small> 
                <h3 class="mt-0 bold"><?=$detail->row('stud_queue')?></h3>
              </div>

              <div class="col-md-6 text-right">
                <small>DATE: </small> 
                <h5 class="m-0 bold">
                  <?php 
                  date_default_timezone_set("Asia/Manila");
                  $dt = new DateTime();
                  echo $dt->format('F d, Y, l');

                  ?>
                </h5>
              </div>

            </div>

            <div class="row">
              <div class="col-md-12">
                  <small>GRADE/SECTION: </small>
                  <h4 class="bold mt-0 section"><?= $detail->row('lvl_name').' - '. $detail->row('sec_name')?></h4>
              </div>

            </div>

            <div class="row">
              <div class="col-md-12">
                <small>STUDENT NAME: </small>
                <h4 class="bold mt-0"><?= strtoupper($detail->row('stud_lastname')) .', '.strtoupper($detail->row('stud_firstname')).' '.strtoupper($detail->row('stud_middlename')).' '.strtoupper($detail->row('stud_suffix')) ?></h4>
              </div>
            </div>

            <hr/>

            <table class="table table-responsive table-condensed">
              <thead>
                <tr>
                  <th colspan="2" style="background-color:#eee" class="bold">Description</th>
                  <th width="20%" style="background-color:#eee"></th>
                  <th class="text-right bold" width="30%" style="background-color:#eee">Price</th>
                </tr>
              </thead>
              
              <tbody id="tbl_fee">
                <?php 
                  foreach($assessment->result()  as $r): ?>
                    <tr>
                        <td colspan="4">School Fees</td>
                    </tr>

                    <tr>
                        <td></td>
                        <td> &nbsp;&nbsp;&nbsp; <em><i class="fa fa-caret-right"></i> Tuition Fee </em></td>
                        <td class="text-right"><em><?= number_format($r->as_tf,2) ?></em></td>
                        <td></td>
                    </tr>

                    <tr>
                        <td></td>
                        <td> &nbsp;&nbsp;&nbsp; <em><i class="fa fa-caret-right"></i> Miscellaneous Fees</em></td>
                        <td class="text-right"><em><?= number_format($r->as_other_schl_fee,2) ?></em></td>
                        <td class="text-right">
                          <?php 
                            $total = ( $r->as_other_schl_fee + $r->as_tf);
                            echo number_format($total,2);
                          ?>
                        </td>
                    </tr>

                    <tr>
                        <td></td>
                        <td> &nbsp;&nbsp;&nbsp; <em><i class="fa fa-caret-right"></i> Sibling Discount</em></td>
                        <td class="text-right"><em> - <?= number_format($r->as_sib_amount,2) ?></em></td>
                        <td></td>
                    </tr>

                    <tr>
                        <td></td>
                        <td> &nbsp;&nbsp;&nbsp; <em><i class="fa fa-caret-right"></i> Reservation</em></td>
                        <td class="text-right"><em> - <?= number_format($r->as_reservation,2) ?></em></td>
                        <td></td>
                    </tr>

                    <tr>
                        <td></td>
                        <td class="bold"><em>&nbsp;&nbsp;&nbsp; Total School Fees</em></td>
                        <td class="text-right bold" colspan="2"><?= number_format($r->as_disc_tf,2) ?></td>
                    </tr>

                    <tr>
                        <td colspan="4">Others:</td>
                    </tr>

                    <tr>
                        <td>1</td>
                        <td colspan="2">Books</td>
                        <td  class="text-right"><?= number_format($r->as_book,2) ?></td>
                    </tr>

                    <tr>
                        <td>2</td>
                        <td colspan="2">Notebooks/Diary</td>
                        <td  class="text-right"><?= number_format($r->as_notebook,2) ?></td>
                    </tr>

                    <tr>
                        <td>3</td>
                        <td colspan="2">School Uniforms</td>
                        <td  class="text-right"><?= number_format($r->as_uniform,2) ?></td>
                    </tr>

                    <tr>
                        <td>4</td>
                        <td colspan="2">P.E. Shoes</td>
                        <td  class="text-right"><?= number_format($r->as_others,2) ?></td>
                    </tr>

                    <tr>
                      <td></td>
                      <td class="bold" colspan="2"> TOTAL </td>
                      <td class="text-right">
                        <h2 class="bold m-0"><?= number_format($r->as_total,2) ?> </h2>
                      </td>
                    </tr>

                    <tr>
                      <td colspan="4" class="no-border"><small><em> 
                          <span class="bold">
                          <?php 
                              $as_mode = $r->as_mode ;

                              switch ($as_mode) {
                                  case "Semestral":
                                      echo 'NOTE:<br/> Your next payment is on/before OCTOBER 15.<br/>Thank You!';
                                  break;

                                  case "Quarterly":
                                      echo 'NOTE: <br/>Your next payment is on/before AUGUST 15.<br/>Thank You!';
                                  break;

                                  case "Monthly":
                                      echo 'NOTE: <br/> Your next payment is on/before JULY 15.<br/>Thank You!';
                                  break;

                                  default:
                              }
                          ?>
                          </span></em></small>
                      </td>
                  </tr>
                  
                  <tr>
                    <td colspan="4">
                        <form  class="form-horizontal form-groups-bordered" id="frmSavePrint" action="<?php echo base_url()?>admin/save_print" method="POST">
                            <input type="hidden" name="stud_id" value="<?=$r->stud_id?>">
                            <input type="hidden" name="stud_type" value="<?=$r->stud_type?>">
                            <input type="hidden" name="lvl_id" value="<?=$r->lvl_id?>">
                            <input type="hidden" name="sy_id" value="<?=$r->sy_id?>">
                            <input type="hidden" name="as_mode" value="<?=$r->as_mode?>">
                            <input type="hidden" name="as_sib_discount" value="<?=$r->as_sib_discount?>">
                            <input type="hidden" name="as_sib_amount" value="<?=$r->as_sib_amount?>">
                            <input type="hidden" name="as_is_reserve" value="<?=$r->as_is_reserve?>">
                            <input type="hidden" name="as_reservation" value="<?=$r->as_reservation?>">
                            <input type="hidden" name="as_tf" value="<?=$r->as_tf?>">
                            <input type="hidden" name="as_other_schl_fee" value="<?=$r->as_other_schl_fee?>">
                            <input type="hidden" name="as_disc_tf" value="<?=$r->as_disc_tf?>">
                            <input type="hidden" name="as_book" value="<?=$r->as_book?>">
                            <input type="hidden" name="as_notebook" value="<?=$r->as_notebook?>">
                            <input type="hidden" name="as_uniform" value="<?=$r->as_uniform?>">
                            <input type="hidden" name="as_others" value="<?=$r->as_others?>">
                            <input type="hidden" name="as_total" value="<?=$r->as_total?>">

                            <div class="text-right">
                               <!--  <button class="btn btn-success save" type="button" > <i class="fa fa-save"></i> Save Only</button> -->
                                <button class="btn btn-primary" type="submit" > <i class="fa fa-print"></i> Save and Print</button>
                            </div>

                        </form>
                    </td>
                </tr>
                    

                <?php endforeach; ?>
              </tbody>
            </table>

            <div id="msg"></div>

          </div>
        </div>
      </div>
        
    </div><!---END MAIN CONTENT -->

    
    
</div> <!-- end of body container -->

<?= $this->load->view('inc/js')?>
<script type="text/javascript" charset="utf-8">
  $(document).ready(function() {
      $(".datatable").dataTable({
            "sPaginationType": "bootstrap"
        });

      $('.digit').ForceNumericOnly();

      $('#frmSubmit').submit(function(e){
          e.preventDefault(); 
          var base  = $(this);
          var msg   = base.find(".msg");
          var btn   = base.find("button");

          var txt_sec = $('.txt_sec option:selected').text();
          var txt_lvl = $('.txt_lvl option:selected').text();

            $.ajax({
            type:base.attr("method"),//get/post
            data:base.serialize(),
            url:base.attr("action"),
            success:function(rrdata){
                $('#tbl_fee').html(rrdata); 
                $('.section').html(txt_lvl+' - '+txt_sec);
            },
            error:function(rdata){
              btn.prop("disabled",false);
              msg.empty().html(alert_error('An error occured, please try again later'));
            }
          });
      });


      $('#frmSubmitScholar').submit(function(e){
          e.preventDefault(); 
          var base  = $(this);
          var msg   = base.find(".msg");
          var btn   = base.find("button");

          var txt_sec_sch = $('.txt_sec_sch option:selected').text();
          var txt_lvl_sch = $('.txt_lvl_sch option:selected').text();

          $('.section').html(txt_sec_sch +' - '+ txt_lvl_sch);

            $.ajax({
            type:base.attr("method"),//get/post
            data:base.serialize(),
            url:base.attr("action"),
            success:function(rrdata){
                $('#tbl_fee').html(rrdata); 
                

            },
            error:function(rdata){
              btn.prop("disabled",false);
              msg.empty().html(alert_error('An error occured, please try again later'));
            }
          });
      });


      $('#frmSubmitMode').submit(function(e){
          e.preventDefault(); 
          var base  = $(this);
          var msg   = base.find(".msg");
          var btn   = base.find("button");

          var as_mode = $('.as_mode option:selected').val();
          //var as_mode = $('.as_mode option:selected').text();
          //$('.section').html(txt_sec_sch +' - '+ txt_lvl_sch);

            $.ajax({
            type:base.attr("method"),//get/post
            data:base.serialize(),
            url:base.attr("action"),
            success:function(rrdata){
                $('#tbl_fee').html(rrdata); 
                

            },
            error:function(rdata){
              btn.prop("disabled",false);
              msg.empty().html(alert_error('An error occured, please try again later'));
            }
          });
      });


      $(document.body).on("submit", "#frmSavePrint",function(e){
        e.preventDefault(); 

        var base  = $(this);
        var msg   = $("#msg");
        var btn   = base.find("button");

          $.ajax({
          type:base.attr("method"),//get/post
          data:base.serialize(),
          url:base.attr("action"),//location for the url
          beforeSend:function(){
            msg.empty().html(alert_minimal('Processing . . .'));
            btn.prop("disabled",true);
          },
          success:function(rrdata){

            btn.prop("disabled",false);
            var rdata = $.parseJSON(rrdata);
            if(rdata.stat){
              msg.empty().html(alert_success(rdata.msg)).show();
              
              window.setTimeout(function(){
                window.location = base_url + 'admin/print_assessment/'+rdata.id;
              },500)
            }
            else{
              msg.empty().html(alert_error(rdata.msg));
            }
            
          },
          error:function(rdata){
            btn.prop("disabled",false);
            msg.empty().html(alert_error('An error occured, please try again later'));
          }
        });
      });




      $('.txt_lvl').on('change', function(){
        var txt_lvl = $(this).val();
          $('.txt_sec').load(base_url+'admin/get_section/'+txt_lvl);
      });

      /*$(document.body).on("click", ".save",function(e){
        e.preventDefault(); 

        $('#frmSavePrint').attr('action', base_url+'admin/save_only');
        var newForm = jQuery('<form>', {
            'action': 'http://www.google.com/search',
            'target': '_top'
        }).append(jQuery('<input>', {
            'name': 'q',
            'value': 'stack overflow',
            'type': 'hidden'
        }));
        newForm.submit();

        
      });*/

      /*$('.save').click(function(e){
        var as_total  = $('#as_total').val();
        var stud_id   = $('#stud_id').val();
        
        
         e.preventDefault(); 
          var base  = $(this);
          //var msg   = base.find("#msg");
          var btn   = base.find("button");

            $.ajax({
            type:'POST',//get/post
            data:{as_total: as_total, stud_id: stud_id},
            url:base_url+ 'admin/save_print',
            success:function(rrdata){
                var rdata = $.parseJSON(rrdata);
                if(rdata.stat){
                  $("#msg").empty().html(alert_success('Save success')).show();
                }
            },
            error:function(rdata){
              btn.prop("disabled",false);
              $("#msg").empty().html(alert_error('An error occured, please try again later'));
            }
          });


      });*/
       
  });
</script>
</body>
</html>