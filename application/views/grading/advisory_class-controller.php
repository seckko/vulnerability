public function advisory_class(){

		$usr_type       = $this->session->userdata('usr_type');
		$tch_id         = $this->session->userdata('tch_id');
		$landing        = $this->session->userdata('landing');

		if(($usr_type <> 'Faculty') || empty($tch_id) ){
		    header('Location: '.base_url().$landing); 
		}else{

			$data['title']		= 'Advisory Class';
			$sec_id 			= $this->uri->segment(3);
			$data['sec_id']		= $sec_id;

			$data['section']	= $this->module->get_query("SELECT * FROM v_section WHERE sec_id =".$sec_id." ");
			$data['boys'] 		= $this->module->get_query("SELECT * FROM v_section_assignment WHERE sec_id = ".$sec_id." AND stud_gender = 'Male' ORDER BY stud_lastname, stud_firstname ASC"); 
			$data['girls'] 		= $this->module->get_query("SELECT * FROM v_section_assignment WHERE sec_id = ".$sec_id." AND stud_gender = 'Female' ORDER BY stud_lastname, stud_firstname ASC"); 
			
			$sy_id 				= $this->module->get_active_sy();

			$student_score_data = array();


			
			$student_section_assignment = $this->module->get_query("SELECT * FROM v_section_assignment WHERE sec_id = ".$sec_id." ORDER BY stud_lastname ASC");
			$subject 					= $this->module->get_query("SELECT * FROM subject ORDER BY sub_sort ASC");
			$quarter 					= $this->module->table_where('quarter', array('qtr_active' => 'Y'))->row('qtr_code');

			$english 	= 0;
			$mapeh		= 0;
			$total_grade = 0;
			

			foreach ($student_section_assignment->result() as $v) {
				$stud_id 				= $v->stud_id;

				$my_subject = array();

				

				foreach ($subject->result() as $k) {
					$sub_id = $k->sub_id;
					$subject_assignment = $this->module->table_where('v_student_section_subject_assignment', array('stud_id' => $stud_id, 'sub_id' => $sub_id));
					$subj_data =	array();

					
					$grade 	= 0;
					$cnt 	= 0;
					foreach($subject_assignment->result() as $p){

						$subj_id 		= $p->subj_id;

						$subj_det_id 	= $p->subj_det_id;
						$quarter_grade  = $this->module->compute_score($sub_id, $quarter,$subj_id,$stud_id);

						array_push($subj_data, array(
							'subj_id' 		=> $subj_id, 
							'subj_det_id' 	=> $subj_det_id, 
							'subj_det_name' => $this->module->table_where('subject_detail', array('subj_det_id' => $subj_det_id))->row('subj_det_name'),
							'score' 		=> $quarter_grade
							
						));

						$grade 	+=  $quarter_grade;
						$cnt++;
					}


					$subjects = array(
						'sub_id' 		=> $sub_id,
						'sub_name'		=> $k->sub_name, 
						'total_score' 	=> $grade,
						'cnt'			=> $cnt,
						'subj_data' 	=> $subj_data,
						
					);

					array_push($my_subject, $subjects);
					
				}

				

				$stud_data = array(
					'stud_id'			=> $stud_id,
					'stud_name' 		=> $v->stud_lastname.', '.$v->stud_firstname,
					'stud_subjects'  	=> $my_subject
				);
				
				array_push($student_score_data, $stud_data);
				
			}
			
			
			$data['student'] = $student_score_data;
			$this->load->view('grading/advisory_class', $data);
		}
	}public function advisory_class(){

		$usr_type       = $this->session->userdata('usr_type');
		$tch_id         = $this->session->userdata('tch_id');
		$landing        = $this->session->userdata('landing');

		if(($usr_type <> 'Faculty') || empty($tch_id) ){
		    header('Location: '.base_url().$landing); 
		}else{

			$data['title']		= 'Advisory Class';
			$sec_id 			= $this->uri->segment(3);
			$data['sec_id']		= $sec_id;

			$data['section']	= $this->module->get_query("SELECT * FROM v_section WHERE sec_id =".$sec_id." ");
			$data['boys'] 		= $this->module->get_query("SELECT * FROM v_section_assignment WHERE sec_id = ".$sec_id." AND stud_gender = 'Male' ORDER BY stud_lastname, stud_firstname ASC"); 
			$data['girls'] 		= $this->module->get_query("SELECT * FROM v_section_assignment WHERE sec_id = ".$sec_id." AND stud_gender = 'Female' ORDER BY stud_lastname, stud_firstname ASC"); 
			
			$sy_id 				= $this->module->get_active_sy();

			$student_score_data = array();


			
			$student_section_assignment = $this->module->get_query("SELECT * FROM v_section_assignment WHERE sec_id = ".$sec_id." ORDER BY stud_lastname ASC");
			$subject 					= $this->module->get_query("SELECT * FROM subject ORDER BY sub_sort ASC");
			$quarter 					= $this->module->table_where('quarter', array('qtr_active' => 'Y'))->row('qtr_code');

			$english 	= 0;
			$mapeh		= 0;
			$total_grade = 0;
			

			foreach ($student_section_assignment->result() as $v) {
				$stud_id 				= $v->stud_id;

				$my_subject = array();

				

				foreach ($subject->result() as $k) {
					$sub_id = $k->sub_id;
					$subject_assignment = $this->module->table_where('v_student_section_subject_assignment', array('stud_id' => $stud_id, 'sub_id' => $sub_id));
					$subj_data =	array();

					
					$grade 	= 0;
					$cnt 	= 0;
					foreach($subject_assignment->result() as $p){

						$subj_id 		= $p->subj_id;

						$subj_det_id 	= $p->subj_det_id;
						$quarter_grade  = $this->module->compute_score($sub_id, $quarter,$subj_id,$stud_id);

						array_push($subj_data, array(
							'subj_id' 		=> $subj_id, 
							'subj_det_id' 	=> $subj_det_id, 
							'subj_det_name' => $this->module->table_where('subject_detail', array('subj_det_id' => $subj_det_id))->row('subj_det_name'),
							'score' 		=> $quarter_grade
							
						));

						$grade 	+=  $quarter_grade;
						$cnt++;
					}


					$subjects = array(
						'sub_id' 		=> $sub_id,
						'sub_name'		=> $k->sub_name, 
						'total_score' 	=> $grade,
						'cnt'			=> $cnt,
						'subj_data' 	=> $subj_data,
						
					);

					array_push($my_subject, $subjects);
					
				}

				

				$stud_data = array(
					'stud_id'			=> $stud_id,
					'stud_name' 		=> $v->stud_lastname.', '.$v->stud_firstname,
					'stud_subjects'  	=> $my_subject
				);
				
				array_push($student_score_data, $stud_data);
				
			}
			
			
			$data['student'] = $student_score_data;
			$this->load->view('grading/advisory_class', $data);
		}
	}