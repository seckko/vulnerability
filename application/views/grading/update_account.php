<?php 

    
  $usr_name       = $this->session->userdata('usr_name');
  $usr_type       = $this->session->userdata('usr_type');
  $usr_firstname  = $this->session->userdata('usr_firstname');
  $usr_lastname   = $this->session->userdata('usr_lastname');
  $usr_is_login   = $this->session->userdata('usr_is_login');
  $tch_id         = $this->session->userdata('tch_id');
  $sy_id          = $this->module->get_active_sy();

  $where           = 'tch_id = "'.$tch_id.'"  AND sy_id = "'.$sy_id.'" ';



  if( ($usr_type <> 'Faculty') || empty($tch_id) ){
    header('Location: '.base_url());
  }

?>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title><?= $title;?></title>

    <?= $this->load->view('inc/css')?>

</head>
<body class="page-body gray">

<div class="page-container  horizontal-menu sidebar-collapsed"><!-- add class "sidebar-collapsed" to close sidebar by default, "chat-visible" to make chat appear always -->
    <header class="navbar navbar-fixed-top"><!-- set fixed position by adding class "navbar-fixed-top" -->
        
        <div class="navbar-inner">
            <?=$this->load->view('inc/topbar');?>
        </div>
    </header>

    <div class="main-content">

        

        <div class="row">

            <div class="col-md-2 col-sm-12">
                <div class="panel panel-primary panel-table">
                    <div class="panel-heading">
                        <div class="panel-title">
                            <h3>Dashboard</h3> 
                            <p>Hi Teacher this is your dashboard</p>
                        </div>
                    </div>

                    <div class="panel-body p-0">
                        <ul class="list-group mb-0"> 
                            <a href="<?=base_url()?>grading" class="list-group-item bold active">
                                <i class="fa fa-leaf"></i> Teacher <?= $usr_firstname.' '.$usr_lastname?>
                            </a>

                            <li class="list-group-item">
                                <a href="<?=base_url()?>grading/update_account"><i class="fa fa-pencil"></i> Update Account</a>
                            </li>

                            <li class="list-group-item">
                                <div class="row text-center text-black">
                                    <div class="col-md-4">
                                        <p class="font-38 mb-0">
                                            <?php 
                                                $sec_cnt = $this->module->get_query("SELECT COUNT(DISTINCT(sec_id)) as cnt FROM v_subject_teacher_assignment WHERE ".$where." ");
                                                echo ($sec_cnt->num_rows() < 1 ? 0 : $sec_cnt->row('cnt') )
                                            ?>
                                        </p>
                                        Sections
                                    </div>

                                    <div class="col-md-4 text-black">
                                        <p class="font-38 mb-0">
                                            <?php 
                                                $lvl_cnt = $this->module->get_query("SELECT COUNT(DISTINCT(lvl_id)) as cnt FROM v_subject_teacher_assignment WHERE ".$where." ");
                                                echo ($lvl_cnt->num_rows() < 1 ? 0 : $lvl_cnt->row('cnt') )
                                            ?>
                                        </p>
                                        Levels

                                    </div>

                                    <div class="col-md-4 text-black">
                                        <p class="font-38 mb-0 ">
                                            <?php 
                                                $sub_cnt = $this->module->get_query("SELECT COUNT(DISTINCT(sub_id)) as cnt FROM v_subject_teacher_assignment WHERE ".$where." ");
                                                echo ($sub_cnt->num_rows() < 1 ? 0 : $sub_cnt->row('cnt') )
                                            ?>
                                        </p>
                                        Subjects
                                    </div>
                                </div>
                            </li>

                            
                        </ul>
                    </div>
                </div>

            </div>

            <div class="col-md-7 col-sm-12">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <div class="panel-title">
                            <h3>Update your Account</h3>
                        </div>
                    </div>

                    <div class="panel-body">
                        
                        <form method="post" id="frmSubmit" action="<?=base_url()?>grading/update_account" class="form-horizontal form-groups-bordered">
                            <div class="msg"></div>
                            <input class="form-control" type="hidden" name="usr_id" value="<?=$user->row('usr_id')?>" >
                           
                            <div class="form-group">
                                <label class="col-sm-2 control-label">Fullname</label>

                                <div class="col-sm-3">
                                    <input class="form-control" type="text" id="usr_firstname" name="usr_firstname" value="<?=$user->row('usr_firstname')?>" autofocus="" required="" autocomplete="off" placeholder="First Name">
                                </div>
                                
                                <div class="col-sm-3">
                                    <input class="form-control" type="text" id="usr_lastname" name="usr_lastname" value="<?=$user->row('usr_lastname')?>" autofocus="" required="" autocomplete="off" placeholder="Last Name">
                                </div>

                                

                            </div>

                            <div class="form-group">
                                <label class="col-sm-2 control-label">Username</label>
                                
                                <div class="col-sm-5">
                                    <input class="form-control" type="text" name="usr_name" value="<?=$user->row('usr_name')?>" autofocus="" required="" autocomplete="off" placeholder="User Name">
                                </div>

                            </div>

                            <div class="form-group">
                                <label class="col-sm-2 control-label">Password</label>
                                
                                <div class="col-sm-5">
                                    <input class="form-control" type="password" name="usr_password" value="<?=$user->row('usr_password')?>" autofocus="" required="" autocomplete="off" placeholder="User Name">
                                </div>
                            </div>


                            <div class="form-group">
                                <div class="col-sm-offset-2 col-sm-5">
                                    <button type="submit" class="btn btn-info"> <i class="fa fa-check"></i> Update</button>
                                    <button type="reset" class="btn btn-default"> Clear</button>
                                </div>
                            </div>
                        </form>
                       
                    </div>
                </div>
            </div>
        </div>
    </div>

    
</div> <!-- end of body container -->


<?= $this->load->view('inc/js')?>
<script type="text/javascript" charset="utf-8">
  $(document).ready(function() {
       $('#frmSubmit').crud_refresh();

  });
</script>
</body>
</html>