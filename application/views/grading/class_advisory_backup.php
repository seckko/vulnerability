public function advisory_class(){

		$usr_type       = $this->session->userdata('usr_type');
		$tch_id         = $this->session->userdata('tch_id');
		$landing        = $this->session->userdata('landing');

		if(($usr_type <> 'Faculty') || empty($tch_id) ){
		    header('Location: '.base_url().$landing); 
		}else{

			$data['title']	= 'Advisory Class';
			$sec_id 		= $this->uri->segment(3);
			$data['section']= $this->module->get_query("SELECT * FROM v_section WHERE sec_id =".$sec_id." ");
			$sy_id 			= $this->module->get_active_sy();
			$quarter 		= $this->module->table_where('quarter', array('qtr_active' => 'Y'))->row('qtr_code');
			$subject 		= $this->module->get_query("SELECT * FROM subject ORDER BY sub_sort ASC");
			$data['sec_id']	= $sec_id;

			$data['boys'] 		= $this->module->get_query("SELECT * FROM v_student_section_subject_assignment WHERE sec_id = ".$sec_id." AND stud_gender = 'Male' GROUP BY stud_id ORDER BY stud_lastname, stud_firstname ASC "); 
			$data['girls'] 		= $this->module->get_query("SELECT * FROM v_student_section_subject_assignment WHERE sec_id = ".$sec_id." AND stud_gender = 'Female' ORDER BY stud_lastname, stud_firstname ASC");

			$student_score_data = array();
			$title 				= array();

			$grade_data = array();
			

			foreach($subject->result() as $s){
				$sub_id 	= $s->sub_id;
				$sub_name 	= $s->sub_name;
				$subj 		= $this->module->table_where('subject_assignment', array('sec_id' => $sec_id, 'sub_id' => $sub_id)); 
				$subj_det_name 	= '';

				$grade 				= array();
				$title_subj_det_name= array(); 

				if($subj->num_rows() > 0 ){
					foreach ($subj->result() as $l) {
						$subj_det_id 	= $l->subj_det_id;
						$subj_id 		= $l->subj_id;
						$get_name		= $this->module->table_where('subject_detail', array('subj_det_id' => $subj_det_id));
						

						if($get_name->num_rows() > 0){
							foreach($get_name->result() as $de){
								$subj_det_name = $de->subj_det_name;
								array_push($title_subj_det_name, array('subj_det_id' => $subj_det_id, 'subj_det_name' => $subj_det_name));
							}							
						}

						$grade_data = $this->module->compute_score($sub_id, $quarter, $subj_id , $sec_id, $sy_id);

						
						//array_push($grade, $grade_data);
					}
				}


				array_push($title, array('sub_id' => $sub_id, 'sub_name' => $sub_name,  'subj_det_name' => $title_subj_det_name ));
				array_push($student_score_data, array('subj_id' => $subj_id,  'sub_id' => $sub_id,'sub_name' => $sub_name, 'subj_det_id' => $subj_det_id, 'subj_det_name' => $subj_det_name , 'grade' => $grade_data));
				
			}

			
			$data['thead']		= $title;
			$data['student'] 	= $student_score_data;
			$this->load->view('grading/advisory_class', $data);
		}
	}