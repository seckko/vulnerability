<!DOCTYPE html>
<html lang="en">
<?= $this->load->view('inc/css')?>

<style type="text/css">
	.form-control{
		border: 1px solid #d3d1d1;
	}
</style>

<body class="page-body gray" style="color:#373e4a">

<div class="page-container horizontal-menu pt-0">

	<div class="main-content">

		<div class="container">

			<div class="panel panel-primary panel-table">
					<div class="panel-heading">
						<div class="panel-title">
							<h2 class="bold">New Student Registration Form</h2>
							<h4 class="m-0">School Year <?=$this->module->get_query("SELECT sy_name FROM school_year WHERE sy_selected = 'Y' ")->row('sy_name');?></4>
						</div>

						<div class="panel-options p-10">
							<button class="btn btn-primary" onclick="goback()"> <i class="fa fa-arrow-left"></i> Back</button>
						</div>
						
					</div>
					<form  class="form-horizontal form-groups-bordered" id="frmSubmit" action="<?php echo base_url()?>registration/new_student" method="POST">
						<div class="panel-body"  style="padding: 30px;">	
							<div class="panel panel-primary panel-shadow">
								
								<!-- panel body -->
								<div class="panel-body">

										<h3>Basic Students' Information</h3>
										<hr/>
										<input type="hidden" name="sy_id" value="<?=$sy_id?>"> 
									
										<div class="form-group">
											<label class="col-sm-2 control-label bold">LRN <br/><small>(Learners Reference Number)</small></label>
											
											<div class="col-sm-6">
												<input type="text" class="form-control input-lg" maxlength="12" name="stud_lrn"  placeholder="418506000000">
											</div>

											<!-- <label class="col-sm-1 control-label">Student No.</label> -->
											
											<div class="col-sm-2">
												<!-- <p class="m-0">Student No.</p>
												 <h3 class="m-0 bold"><?=$stud_no?></h3>
												 
												 <input type="hidden" name="stud_no" value="<?=$stud_no?>"> --> 
											</div> 

										</div>
					
										<div class="form-group">
											<label class="col-sm-2 control-label">Student Name</label>

											<div class="col-sm-3">
												<input type="text" class="form-control" placeholder="First Name" required="" name="stud_firstname">
											</div>

											<div class="col-sm-3">
												<input type="text" class="form-control" placeholder="Middle Name" name="stud_middlename">
											</div>
											
											<div class="col-sm-3">
												<input type="text" class="form-control" placeholder="Last Name" required="" name="stud_lastname">
											</div>



											<div class="col-sm-1">
												<input type="text" class="form-control" placeholder="Suffix" name="stud_suffix">
											</div>

										</div>

										<hr/>

										<div class="form-group">
											<label class="col-sm-2 control-label">Nickname </label>
											
											<div class="col-sm-3">
												<input type="text" class="form-control" name="stud_nickname" required="">
											</div>

											<label class="col-sm-1 control-label">Gender </label>
											
											<div class="col-sm-2">
												<select class="form-control" name="stud_gender" required="">
													<option selected="" disabled="">--Select--</option>
													<option value="Male">Male</option>
													<option value="Female">Female</option>
												</select>
											</div>

											<label class="col-sm-1 control-label text-left">Birthdate </label>
											
											<div class="col-sm-3">
												<input type="text" class="form-control stud_birthdate" name="stud_birthdate" required="">
												<div class="date_msg text-danger bold pt-5"></div>
											</div>

										</div>

										<div class="form-group">
											<label class="col-sm-2 control-label">Handedness </label>
											<div class="col-sm-3">
												<select class="form-control" name="stud_handedness" required="">
													<option selected="" disabled="">--Select--</option>
													<option value="Right-handed">Right-Handed</option>
													<option value="Left-handed">Left-Handed</option>
												</select>

											</div>

											<label class="col-sm-1 control-label ">Religion </label>
											
											<div class="col-sm-6">
												<input type="text" class="form-control" name="stud_religion" required="">
											</div>


										</div>


										<div class="form-group">
											<label class="col-sm-2 control-label">Complete Address </label>
											
											<div class="col-sm-10">
												<textarea class="form-control" name="stud_address" rows="4" required=""></textarea>
											</div>

										</div>
								</div>
								
							</div>

							<div class="panel panel-primary panel-shadow">
								<!-- panel body -->
								<div class="panel-body">
									<h3>Parents/Guardians' Information</h3>
									<hr/>
									<div class="row">
										<div class="col-md-4">
											<!-- for father -->

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label bold">Fathers' Name </label>
													<input type="text" class="form-control" name="stud_father_name">
												</div>
											</div>

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Contact Numbers</label>
													<input type="text" class="form-control digit" name="stud_father_contact" >
												</div>
											</div>

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Occupation </label>
													<input type="text" class="form-control" name="stud_father_occupation" >
												</div>
											</div>

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Office Address </label>
													<textarea class="form-control" name="stud_father_address" rows="3" ></textarea>
												</div>
											</div>

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Educational Attainment </label>
													<input type="text" class="form-control" name="stud_father_education" >
												</div>
											</div>

											
											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Email Address</label>
													<input type="email" class="form-control" name="stud_father_email" >
												</div>
											</div>


										</div>

										<div class="col-md-4">
											<!-- for mother -->

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label bold">Mothers' Name </label>
													<input type="text" class="form-control" name="stud_mother_name" >
												</div>
											</div>

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Contact Numbers</label>
													<input type="text" class="form-control digit" name="stud_mother_contact" >
												</div>
											</div>

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Occupation </label>
													<input type="text" class="form-control" name="stud_mother_occupation" >
												</div>
											</div>

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Office Address </label>
													<textarea class="form-control" name="stud_mother_address" rows="3" ></textarea>
												</div>
											</div>

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Educational Attainment </label>
													<input type="text" class="form-control" name="stud_mother_education" >
												</div>
											</div>

											

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Email Address</label>
													<input type="email" class="form-control" name="stud_mother_email" >
												</div>
											</div>


										</div>

										<div class="col-md-4">
											<!-- for guardian -->
											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label bold">Guardians' Name</label>
													<input type="text" class="form-control" name="stud_guar_name" >
												</div>
											</div>

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Relationship</label>
													<input type="text" class="form-control" name="stud_guar_relation" >
												</div>
											</div>

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Contact Number</label>
													<input type="text" class="form-control" name="stud_guar_contact" >
												</div>
											</div>

											<div class="form-group mb-0">
												<div class="col-md-12">
													<label class="control-label">Address</label>
													<textarea class="form-control" name="stud_guar_address" rows="3" ></textarea>
												</div>
											</div>

											

										</div>
									</div>
								</div>
							</div>

							<div class="panel panel-primary panel-shadow">
								<!-- panel body -->
								<div class="panel-body">
									<h3>Last School Attended</h3>
									<hr/>

									<table class="table table-condensed ">
										<thead>
											<th>School Name</th>
											<th>Grade Level</th>
											<th>Attendance Date</th>
										</thead>
										<tbody>
											<tr>
												<td>
													<input type="text" class="form-control" name="stud_prev_schl_name" placeholder="School Name">
												</td>
												<td>
													<input type="text" class="form-control" name="stud_prev_level" placeholder="Level">
												</td>
												<td>
													<input type="text" class="form-control" name="stud_prev_date" placeholder="Attendance Date">
												</td>
											</tr>
										</tbody>
									</table>

								</div>
							</div>

							<div class="panel panel-primary panel-shadow">
								<!-- panel body -->
								<div class="panel-body">
									<h3 class="text-success">Message Cast</h3>
									<label>
										Our school is subscribed to Sun Cellular’s Message Cast Service which enables parents to receive school announcements/ news via SMS promptly. 
											With this, may we request you to indicate <strong>ONE (1) CONTACT NUMBER </strong> that will receive official announcements from the school.
									</label>
									<hr/>

									<div class="form-group">
										<label class="col-sm-2 control-label">Name of Parent/Guardian:</label>
										
										<div class="col-sm-10">
											<div class="col-md-6 p-0">
												<input type="text" class="form-control has-success" name="stud_guardian_name" required="" placeholder="Name">
											</div>

											<div class="col-md-6">
												<input type="text" class="form-control digit digit" name="stud_guardian_contact" required="" placeholder="Contact Number" maxlength="11">
											</div>
											
										</div>

									</div>

								</div>
							</div>

							<div class="panel panel-primary panel-shadow">
								<!-- panel body -->
								<div class="panel-body">
									<h3>Contact Person in case of Emergency</h3>
									<hr/>
									<div class="row">
									<div class="col-md-5">
										<div class="form-group">
												<div class="col-md-12">
													<label >Name</label>
													<input type="text" class="form-control" name="stud_emergency_name" placeholder="Name" required="">
												</div>
											</div>
										</div>

										<div class="col-md-3">
											<div class="form-group">
												<div class="col-md-12">
													<label >Relationship</label>
													<input type="text" class="form-control" name="stud_relationship" placeholder="Relationship" required="">
													<!-- <select class="form-control" name="stud_relationship" required="">
														<option selected="" disabled="">RELATIONSHIP</option>
														<option value="Mother">Mother</option>
														<option value="Father">Father</option>
														<option value="Sibling">Sibling</option>
														<option value="Grand Parent">Grand Parent</option>
													</select> -->
												</div>
											</div>
										</div>

										<div class="col-md-3">
											<div class="form-group">
												<div class="col-md-12">
													<label >Contact Number</label>
													<input type="text" class="form-control" name="stud_emergency_contact" placeholder="Contact Numbers" required="">
												</div>
											</div>
										</div>

									</div>
								</div>
							</div>

							<div class="panel panel-primary panel-shadow">
								<!-- panel body -->
								<div class="panel-body">
									<h3>Siblings</h3>
									<hr/>

									<table class="table table-condensed ">
										<thead>
											<th class="text-center" width="3%">No.</th>
						                    <th class="text-center" >Name</th>
						                    <th class="text-center" width="10%">Gender</th>
						                    <th class="text-center" width="10%">Age</th>
						                    <th class="text-center">School</th>
						                    <th class="text-center" width="15%">Level</th>
										</thead>
										<tbody>
											<?php for($i=1; $i<=3; $i++):?>
												<tr>
													<td class="text-right valign text-center"><?=$i?></td>
													<td>
														<input type="text" class="form-control" name="sib<?=$i?>[sib_name]" placeholder="Name">
													</td>

													<td>
														<select class="form-control" name="sib<?=$i?>[sib_gender]" >
															<option selected="" disabled="">--Select--</option>
															<option value="Male">Male</option>
															<option value="Female">Female</option>
														</select>
													</td>

													<td>
														<input type="text" class="form-control digit" name="sib<?=$i?>[sib_age]" placeholder="Age">
													</td>

													<td>
														<input type="text" class="form-control" name="sib<?=$i?>[sib_school]" placeholder="Previous School">
													</td>
													<td>
														<input type="text" class="form-control" name="sib<?=$i?>[sib_level]" placeholder="Grade/Level">
													</td>
												</tr>
											<?php endfor;?>
										</tbody>
									</table>

								</div>
							</div>

							<div class="panel panel-primary panel-shadow" >
								<div class="panel-heading" style="background-color: #007d3d">
									<div class="panel-title "><h3 class="text-white">Initial Assessment</h3></div>
								</div>
								<!-- panel body -->
								<div class="panel-body">
									<!-- <h3 class="text-danger">Initial Assessment</h3>
									<hr/> -->

									<table class="table table-condensed ">
										<thead>
											<th class="bold">Grade Level</th>
											<th class="bold">Mode of Payment</th>
										</thead>
										<tbody>
											<tr>
												<td>
													<select class="form-control" name="lvl_id"> 
														<?php  foreach($level->result() as $g): ?>
															<option value="<?=$g->lvl_id?>"><?=$g->lvl_name?></option>
														<?php endforeach; ?>
													</select>
												</td>

												<td>
													<select class="form-control" name="as_mode"> 
														<option value="Monthly">MONTHLY</option>
														<option value="Quarterly">QUARTERLY</option>
														<option value="Semestral">SEMESTRAL</option>
														<option value="Cash">ANNUAL (CASH)</option>
													</select>
												</td>
											</tr>
										</tbody>
									</table>

								</div>
							</div>

							<hr/>

							<div class="row">
								<div class="col-md-3">
									<button class="btn btn-success btn-lg btn-block btn-icon icon-left" type="submit"> <i class="fa fa-check"></i> SUBMIT APPLICATION</button>
								</div>
								<!-- <div class="col-md-1 pl-0">
									<button class="btn btn-lg btn-default btn-block" type="reset">Clear</button>
								</div> -->
							</div>
							<br/>
							<div class="msg"></div>

						</div>
					</form>
				</div>

		</div>

	</div>

</div>
	<?= $this->load->view('inc/js')?>

	<script type="text/javascript">
	  $(document).ready(function() {
	  	$('.stud_birthdate').mask('00/00/0000', {placeholder: "mm/dd/yyyy"});

	  	$('#frmSubmit').submit(function(e){
	  		e.preventDefault(); 

	  		var base 	= $(this);
			var msg 	= base.find(".msg");
			var btn 	= base.find("button");

	  		$.ajax({
				type:base.attr("method"),//get/post
				data:base.serialize(),
				url:base.attr("action"),//location for the url
				beforeSend:function(){
					msg.empty().html(alert_minimal('Processing . . .'));
					btn.prop("disabled",true);
				},
				success:function(rrdata){

					btn.prop("disabled",false);
					var rdata = $.parseJSON(rrdata);
					if(rdata.stat){
						msg.empty().html(alert_success(rdata.msg)).show();
						
						window.setTimeout(function(){
							window.location = base_url + 'registration/print_student/'+rdata.id;
						},3000)
					}
					else{
						msg.empty().html(alert_error(rdata.msg));
					}
					
				},
				error:function(rdata){
					btn.prop("disabled",false);
					msg.empty().html(alert_error('An error occured, please try again later'));
				}
			});
	  	});

	  	//GET AGE GROUP
		$('.stud_birthdate').on('change', function(){
		//$(document.body).on('change','.stud_birthdate',function(){
			var birthdate = $(this).val();
			var date_now  = $('#date_now').val();

			if (Date.parse(birthdate) > Date.parse(date_now)) {
				$(this).val('');
				$('.date_msg').html('Invalid date format (mm/dd/yyyy)');
			}else{
				if(validate_date(birthdate) == true ){
					$('.date_msg').html('');
				}else{
					$(this).val('');
					$('.date_msg').html('Invalid date format (mm/dd/yyyy)');
				}
			}
			
		});

	  });


	$(".digit").keypress(function (e) {
	     //if the letter is not digit then display error and don't type anything
	     if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
	        //display error message
	        $("#errmsg").html("Digits Only").show().fadeOut("slow");
	               return false;
	    }
	});

	$('.type').click(function() {

		$type = $(this).is(':checked');

		//var isChecked = $('#rdSelect').prop('checked');


		if($type){
			$('.stud_no').prop('disabled', false);
		}else{
			$('.stud_no').prop('disabled', true);
		}
	    //$('input[type="radio"]').not(':checked').prop("checked", true);
	});



	function validate_date(birthdate){
		var bdate = birthdate;
		var comp = bdate.split('/');
		var m = parseInt(comp[0], 10);
		var d = parseInt(comp[1], 10);
		var y = parseInt(comp[2], 10);
		var date = new Date(y,m-1,d);
		if (date.getFullYear() == y && date.getMonth() + 1 == m && date.getDate() == d) {
		  return true;
		} else {
		  return false;
		}
	}

	function goback(){
	  window.location.href = base_url+'/registration';
 	}

	</script>
</body>
</html>