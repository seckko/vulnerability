<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title><?= $title;?></title>

    <?= $this->load->view('inc/css')?>

</head>
<body class="page-body gray">

<div class="page-container"><!-- add class "sidebar-collapsed" to close sidebar by default, "chat-visible" to make chat appear always -->
    
    <div class="sidebar-menu">

        <div class="sidebar-menu-inner">
            <?= $this->load->view('inc/sidebar')?>
        </div>

    </div>

    <div class="main-content"> <!---START MAIN CONTENT -->
         
             
        <div class="row">
            <div class="col-md-12">
                <div class="panel panel-primary panel-table">
                    <div class="panel panel-heading">
                        <div class="panel-title">
                            <h2 class="bold"><?=$title?> Summary</h2>
                            <h4 class="">SY <?= $this->module->get_active_sy_name()?></h4>
                        </div>
                        
                    </div>
                    <div class="panel-body">

                    <div class="row">
                       <div class="col-md-12">
                            <table class="table responsive table-bordered table-condensed table-striped">
                                <thead>
                                    <tr>
                                        <th colspan="2"></th>
                                        <th colspan="3" class="text-center" style="background-color: #045702;"><h4 class="bold m-0 text-white">MONTHLY</h4></th>
                                        <th colspan="3"class="text-center" style="background-color: #2c7ea1;"><h4 class="bold m-0 text-white">QUARTERLY</h4></th>
                                        <th colspan="3"class="text-center" style="background-color: #574802;"><h4  class="bold m-0 text-white">SEMESTRAL</h4></th>
                                        <th colspan="3"class="text-center" style="background-color: #ac1818;"><h4  class="bold m-0 text-white">ANNUAL</h4></th>
                                        <th rowspan="2" class="text-center vmiddle" style="background-color: #1f4495;"><h4  class="bold m-0 text-white">TOTAL</h4></th>
                                    </tr>
                                    
                                    <tr>
                                        <th ><h5 class="m-0 bold text-center">GRADE LEVEL</h5></th>
                                        <th class="text-center "><h5 class="m-0 bold">Discount</h5></th>
                                        <th class="text-center " style="background-color: #045702;"><h5 class="m-0 bold text-white">No</h5></th>
                                        <th class="text-center " style="background-color: #045702;"><h5 class="m-0 bold text-white">Fee</h5></th>
                                        <th class="text-center " style="background-color: #045702;"><h5 class="m-0 bold text-white">Total</h5></th>
                                        <th class="text-center " style="background-color: #2c7ea1;"><h5 class="m-0 bold text-white">No</h5></th>
                                        <th class="text-center " style="background-color: #2c7ea1;"><h5 class="m-0 bold text-white">Fee</h5></th>
                                        <th class="text-center " style="background-color: #2c7ea1;"><h5 class="m-0 bold text-white">Total</h5></th>
                                        <th class="text-center " style="background-color: #574802;"><h5 class="m-0 bold text-white">No</h5></th>
                                        <th class="text-center " style="background-color: #574802;"><h5 class="m-0 bold text-white">Fee</h5></th>
                                        <th class="text-center " style="background-color: #574802;"><h5 class="m-0 bold text-white">Total</h5></th>
                                        <th class="text-center " style="background-color: #ac1818;"><h5 class="m-0 bold text-white">No</h5></th>
                                        <th class="text-center " style="background-color: #ac1818;"><h5 class="m-0 bold text-white">Fee</h5></th>
                                        <th class="text-center " style="background-color: #ac1818;"><h5 class="m-0 bold text-white">Total</h5></th>
                                    </tr>
                                </thead>

                                <tbody>
                                   <?php 
                                     $tnmo   = 0;
                                     $tnqtr  = 0;
                                     $tnsem  = 0;
                                     $tnann  = 0;

                                     $tmo   = 0;
                                     $tqtr  = 0;
                                     $tsem  = 0;
                                     $tann  = 0;

                                     $overall_total = 0;

                                    foreach($grade_level->result() as $r): 
                                            $glvl_id = $r->lvl_id;

                                            $mo_no      = 0;
                                            $qtr_no     = 0;
                                            $sem_no     = 0;
                                            $ann_no     = 0;

                                            $dmo_no      = 0;
                                            $dqtr_no     = 0;
                                            $dsem_no     = 0;
                                            $dann_no     = 0;

                                            $mo_fee      = 0;
                                            $qtr_fee     = 0;
                                            $sem_fee     = 0;
                                            $ann_fee     = 0;

                                            $dmo_fee      = 0;
                                            $dqtr_fee     = 0;
                                            $dsem_fee     = 0;
                                            $dann_fee     = 0;


                                            $disc_total     = 0;
                                            $nondisc_total  = 0;

                                            //$mo_total       = 0;

                                           

                                            $dmo_total  = 0;
                                            $dqtr_total = 0;
                                            $dsem_total = 0;
                                            $dann_total = 0;

                                            $mo_total   = 0;
                                            $qtr_total  = 0;
                                            $sem_total  = 0;
                                            $ann_total  = 0;


                                    ?>
                                        

                                        <?php foreach($tf_summary->result() as $t): 
                                            $tlvl_id                = $t->lvl_id;
                                            $tlvl_name              = $t->lvl_name;
                                            $tse_mode_payment       = $t->se_mode_payment;
                                            $tsad_has_sib_discount  = $t->sad_has_sib_discount;
                                            $cnt                    = $t->cnt;
                                            $tsa_is_scholar         = $t->sad_is_scholar;
                                            $tfee                   = $t->sad_sub_total;
                                            $tdfee                  = $t->discounted;




                                            if( $tlvl_id == $glvl_id ){

                                                if( ($tsad_has_sib_discount == 'Y') && ($tsa_is_scholar == 'N') ){

                                                    if ($tse_mode_payment == 'MONTHLY') {
                                                        $mo_no      = $cnt;
                                                        $mo_fee     = $tdfee;
                                                        $mo_total   = ($mo_no * $mo_fee); //non discounted
                                                    }

                                                    if ($tse_mode_payment == 'QUARTERLY') {
                                                        $qtr_no     = $cnt;
                                                        $qtr_fee    = $tdfee;
                                                        $qtr_total  = ($qtr_no * $qtr_fee); //non discounted
                                                    }
                                                    if ($tse_mode_payment == 'SEMESTRAL') {
                                                        $sem_no     = $cnt;
                                                        $sem_fee    = $tdfee;
                                                        $sem_total  = ($sem_no * $sem_fee); //non discounted
                                                    } 
                                                    if ($tse_mode_payment == 'CASH') {
                                                        $ann_no     = $cnt;
                                                        $ann_fee    = $tdfee;
                                                        $ann_total  = ($ann_no * $ann_fee); //non discounted
                                                    }
                                                }

                                                
                                                /////////////////////////////
                                                

                                                if( ($tsad_has_sib_discount == 'N') && ($tsa_is_scholar == 'N') ){

                                                    if ($tse_mode_payment == 'MONTHLY') {
                                                        $dmo_no     = $cnt;
                                                        $dmo_fee    = $tfee;
                                                        $dmo_total  = ($dmo_no * $dmo_fee); //discounted
                                                    }
                                                    if ($tse_mode_payment == 'QUARTERLY') {
                                                        $dqtr_no    = $cnt;
                                                        $dqtr_fee   = $tfee;
                                                        $dqtr_total = ($dqtr_no * $dqtr_fee); //discounted
                                                    }
                                                    if ($tse_mode_payment == 'SEMESTRAL') {
                                                        $dsem_no    = $cnt;
                                                        $dsem_fee   = $tfee;
                                                        $dsem_total = ($dsem_no * $dsem_fee); //discounted
                                                    }
                                                    if ($tse_mode_payment == 'CASH') {
                                                        $dann_no    = $cnt;
                                                        $dann_fee   = $tfee;
                                                        $dann_total = ($dann_no * $dann_fee); //discounted
                                                    }
                                                }
                                            }

                                                $nondisc_total  = $mo_total + $qtr_total + $sem_total + $ann_total;
                                                $disc_total     = $dmo_total + $dqtr_total + $dsem_total + $dann_total;

                                               
                                        ?>  
                                                
                                        <?php endforeach;?>  
                                        
                                        <?php 

                                             $tnmo   += $mo_no + $dmo_no;
                                             $tnqtr  += $qtr_no + $dqtr_no;
                                             $tnsem  += $sem_no + $dsem_no;
                                             $tnann  += $ann_no + $dann_no;

 
                                            $tmo   += $mo_total + $dmo_total; 
                                            $tqtr  += $qtr_total + $dqtr_total; 
                                            $tsem  += $sem_total + $dsem_total; 
                                            $tann  += $ann_total + $dann_total; 

                                            $overall_total += $nondisc_total + $disc_total;
                                        ?>
                                    
                                    <tr>
                                        <td rowspan="2" class="bold vmiddle text-center"><?=$r->lvl_name?></td>   
                                        <td class="text-center">N</td>
                                        <td class="text-center"><?=$dmo_no?></td>
                                        <td class="text-right"><?=number_format($dmo_fee,2)?></td>
                                        <td class="text-right text-danger"><?=number_format($dmo_total,2)?></td>
                                        <td class="text-center"><?=$dqtr_no?></td>
                                        <td class="text-right"><?=number_format($dqtr_fee,2)?></td>
                                        <td class="text-right text-danger"><?=number_format($dqtr_total,2)?></td>
                                        <td class="text-center"><?=$dsem_no?></td>
                                        <td class="text-right"><?=number_format($dsem_fee,2)?></td>
                                        <td class="text-right text-danger"><?=number_format($dsem_total,2)?></td>
                                        <td class="text-center"><?=$dann_no?></td>
                                        <td class="text-right"><?=number_format($dann_fee,2)?></td>
                                        <td class="text-right text-danger"><?=number_format($dann_total,2)?></td>
                                        <td class="text-right text-success"><?=number_format($disc_total,2)?></td>
                                    </tr>
                                    <tr>
                                        <td class="text-center">Y</td> 
                                        <td class="text-center"><?=$mo_no?></td>
                                        <td class="text-right"><?=number_format($mo_fee,2)?></td>
                                        <td class="text-right text-danger"><?=number_format($mo_total,2)?></td>
                                        <td class="text-center"><?=$qtr_no?></td>
                                        <td class="text-right"><?=number_format($qtr_fee,2)?></td>
                                        <td class="text-right text-danger"><?=number_format($qtr_total,2)?></td>
                                        <td class="text-center"><?=$sem_no?></td>
                                        <td class="text-right"><?=number_format($sem_fee,2)?></td>
                                        <td class="text-right text-danger"><?=number_format($sem_total,2)?></td>
                                        <td class="text-center"><?=$ann_no?></td>
                                        <td class="text-right"><?=number_format($ann_fee,2)?></td>
                                        <td class="text-right text-danger"><?=number_format($ann_total,2)?></td>
                                        <td class="text-right text-success"><?=number_format($nondisc_total,2)?></td>
                                    </tr>

                                   <?php endforeach;?>
                                </tbody>

                                <tfoot>
                                    <tr>
                                        <td class="text-center" colspan="2">TOTAL</td>
                                        <td class="text-center"><?=$tnmo?></td>
                                        <td></td>
                                        <td class="text-right"><?=number_format($tmo,2)?></td>
                                        <td class="text-center"><?=$tnqtr?></td>
                                        <td></td>
                                        <td class="text-right"><?=number_format($tqtr,2)?></td>
                                        <td class="text-center"><?=$tnsem?></td>
                                        <td></td>
                                        <td class="text-right"><?=number_format($tsem,2)?></td>
                                        <td class="text-center"><?=$tnann?></td>
                                        <td></td>
                                        <td class="text-right"><?=number_format($tann,2)?></td>
                                        <td class="text-right "><h4 class=" m-0"><?=number_format($overall_total,2)?></h4></td>
                                    </tr>
                                </tfoot>
                            </table>
                       </div>
                   </div>



                       
                    </div>
                </div>
            </div>
        </div>
        
    </div><!---END MAIN CONTENT -->

    
    
</div> <!-- end of body container -->

<?= $this->load->view('inc/js')?>
<script type="text/javascript" charset="utf-8">
  $(document).ready(function() {
      
       
  });
</script>
</body>
</html>