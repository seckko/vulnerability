<?php
// output headers so that the file is downloaded rather than displayed
/*header('Content-type: text/csv');
header('Content-Disposition: attachment; filename="'.$grade_level.'.csv"');*/

/*header('Content-Encoding: UTF-8');
header('Content-Type: text/csv; charset=utf-8' );
header(sprintf( 'Content-Disposition: attachment; filename="'.$grade_level.'.csv"', date( 'd m Y' ) ) );
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
header('Pragma: public');*/

header('Content-Description: File Transfer');
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename="'.$mode.'.csv"', date( 'd m Y' ));
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
header('Pragma: public');
echo "\xEF\xBB\xBF"; // UTF-8 BOM


 
// do not cache the file
header('Pragma: no-cache');
header('Expires: 0');
 
// create a file pointer connected to the output stream
$file = fopen('php://output', 'w');
 
// send the column headers
fputcsv($file, array('LastName', 'FirstName', 'MobileNo', 'Email Address'));
 

// output each row of the data
$data  = array();

foreach ($mop->result() as $k) {
	array_push($data, array(
		$k->stud_lastname,
		$k->stud_firstname,
		$k->stud_guardian_contact
	));
}

foreach ($data as $row)
{	
	fputcsv($file, $row);
}
 
exit();

?>