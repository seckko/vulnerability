<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class GET_form_validation extends CI_Form_validation {
	var $ci; //global variable
	
	public function  __construct(){
		parent::__construct();
		$this->ci =& get_instance();
	}
	
	// CALLBACK FUNCTIONS
	public function alpha_dash_space($str){
		if (! preg_match("/^([-a-z0-9_ ])+$/i", $str)) {
			$this->ci->form_validation->set_message('alpha_dash_space', 'The %s field may only contain alpha-numeric characters, spaces, underscores, and dashes.');
			return FALSE;
		} else {
			return TRUE;
		}
    }
	
	//check if the data exist
	public function is_exist($id,$field){
		$fa = explode('.', $field);
		$query = $this->ci->db->get_where($fa[0],array($fa[1]=>$id));
		if($query->num_rows() === 0){
			$this->ci->form_validation->set_message('is_exist', '%s is not existing.');
			return FALSE;
		}
		else{
			return true;
		}
	}
	
	function exist($str, $value){       

	  list($table, $column) = explode('.', $value, 2);    
	  $query = $this->CI->db->query("SELECT COUNT(*) AS count FROM $table WHERE $column = '$str'");
	  $row = $query->row();

	  //return ($row->count > 0) ? $this->ci->form_validation->set_message('exist', '%s is exist.'); FALSE : TRUE;
	  if($row->count > 0){
		  $this->ci->form_validation->set_message('exist', '%s is exist.');
			return FALSE;
	  }else{
			return true;
		}

	}
	
	
	
	
}

/* End of file get_form_validation.php */
/* Location: ./application/library/get_form_validation.php */